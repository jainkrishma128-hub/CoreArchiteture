using CommonArchitecture.Application.DTOs;
using CommonArchitecture.Core.Entities;
using CommonArchitecture.Core.Interfaces;
using MediatR;

namespace CommonArchitecture.Application.Commands.Menus.CreateMenu;

public class CreateMenuCommandHandler : IRequestHandler<CreateMenuCommand, MenuDto>
{
 private readonly IMenuRepository _menuRepository;

 public CreateMenuCommandHandler(IMenuRepository menuRepository)
 {
 _menuRepository = menuRepository;
 }

 public async Task<MenuDto> Handle(CreateMenuCommand request, CancellationToken cancellationToken)
 {
 var menu = new Menu
 {
 Name = request.Name,
 Icon = request.Icon,
 Url = request.Url,
 ParentMenuId = request.ParentMenuId,
 DisplayOrder = request.DisplayOrder,
 IsActive = true,
 CreatedAt = DateTime.UtcNow
 };

 var createdMenu = await _menuRepository.AddAsync(menu);

 return new MenuDto
 {
 Id = createdMenu.Id,
 Name = createdMenu.Name,
 Icon = createdMenu.Icon,
 Url = createdMenu.Url,
 ParentMenuId = createdMenu.ParentMenuId,
 DisplayOrder = createdMenu.DisplayOrder,
 IsActive = createdMenu.IsActive
 };
 }
}
