@using CommonArchitecture.Application.DTOs
@model ProductDto

@{
    var discountPrice = Model.Price * 1.25m;
    var randomRating = 4.0 + (new Random().NextDouble() * 1.0);
    var randomReviews = new Random().Next(10, 200);
}

<div class="product-card h-100 shadow-sm border-0 transition-hover">
    <div class="product-image position-relative overflow-hidden" style="height: 250px;">
        <img src="https://picsum.photos/seed/@Model.Id/400/400" class="card-img-top h-100 w-100 object-fit-cover" alt="@Model.Name" loading="lazy" />
        
        <div class="product-badges position-absolute top-0 start-0 m-2">
            @if (Model.Stock <= 5 && Model.Stock > 0)
            {
                <span class="badge bg-warning text-dark"><i class="bi bi-exclamation-triangle-fill me-1"></i>Low Stock</span>
            }
            else if (Model.Stock == 0)
            {
                <span class="badge bg-danger"><i class="bi bi-x-circle-fill me-1"></i>Out of Stock</span>
            }
            else
            {
                <span class="badge bg-success shadow-sm"><i class="bi bi-check-circle-fill me-1"></i>In Stock</span>
            }
        </div>

        <div class="product-actions-overlay position-absolute bottom-0 start-0 w-100 p-3 bg-gradient-dark d-flex justify-content-center gap-2 translate-y-100 transition-all">
            <button class="btn btn-light btn-sm rounded-circle shadow-sm btn-quick-view" data-id="@Model.Id" title="Quick View">
                <i class="bi bi-eye"></i>
            </button>
            <button class="btn btn-primary btn-sm rounded-circle shadow-sm btn-add-to-cart" data-product-id="@Model.Id" title="Add to Cart" @(Model.Stock == 0 ? "disabled" : "")>
                <i class="bi bi-cart-plus"></i>
            </button>
        </div>
    </div>
    
    <div class="card-body p-3">
        <span class="text-muted small text-uppercase mb-1 d-block">@Model.CategoryName</span>
        <h5 class="card-title mb-2 text-truncate">
            <a href="/Ecommerce/Shop/ProductDetail/@Model.Id" class="text-decoration-none text-dark fw-bold">@Model.Name</a>
        </h5>
        
        <div class="d-flex align-items-center mb-2">
            <div class="text-warning small me-2">
                @for(int i=0; i<4; i++) { <i class="bi bi-star-fill"></i> }
                <i class="bi bi-star-half"></i>
            </div>
            <span class="text-muted small">(@randomReviews)</span>
        </div>

        <div class="d-flex align-items-center gap-2">
            <span class="fs-5 fw-bold text-primary">$@Model.Price.ToString("F2")</span>
            <span class="text-muted text-decoration-line-through small">$@discountPrice.ToString("F2")</span>
        </div>
    </div>
</div>

<style>
    .transition-hover {
        transition: all 0.3s ease;
    }
    .transition-hover:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
    }
    .product-image:hover .product-actions-overlay {
        transform: translateY(0);
    }
    .translate-y-100 {
        transform: translateY(100%);
    }
    .bg-gradient-dark {
        background: linear-gradient(transparent, rgba(0,0,0,0.7));
    }
    .object-fit-cover {
        object-fit: cover;
    }
</style>
